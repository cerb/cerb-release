{
    "name": "ai.cerb.eventHandler.automation",
    "description": "",
    "extension_id": "cerb.trigger.interaction.internal",
    "script": "inputs:\n  text/trigger:\n    required@bool: yes\n    type: freeform\n\nstart:\n  await:\n    form:\n      elements:\n        say/heading:\n          content: ## Choose Automation\n          \n        sheet/prompt_automation_id:\n          data:\n            automation:\n              uri: cerb:automation:cerb.data.records\n              inputs:\n                record_type: automation\n                query_required@text:\n                  trigger:{{inputs.trigger}}\n          limit: 10\n          required@bool: yes\n          schema:\n            layout:\n              paging@bool: yes\n              headings@bool: no\n              filtering@bool: yes\n              title_column: _label\n            columns:\n              selection/id:\n                params:\n                  mode: single\n              text/_label:\n                params:\n                  bold@bool: yes\n              text/description:\n          toolbar:\n            interaction/add:\n              label: Create\n              icon: circle-plus\n              hidden@bool: {{not worker_is_superuser}}\n              uri: cerb:automation:ai.cerb.automation.create\n              #inputs:\n              #after:\n\n  set/load_automation:\n    automation_data__context: automation\n    automation_data_id@key: prompt_automation_id\n\n  return:\n    snippet@text:\n      {% apply spaceless %}\n      {% set automation_key = 'automation/' ~ random_string(6)|lower %}\n      {% set kata = \n        {\n          (automation_key): {\n            'uri': 'cerb:automation:' ~ automation_data_name,\n            '#disabled@bool': 'yes',\n          }\n        }\n      %}\n      {% set inputs = automation_data_inputs %}\n      {% if inputs is iterable and inputs is not empty %}\n        {% set kata = dict_set(kata, automation_key ~ '.inputs', []) %}\n        {% for input in inputs %}\n          {% if input.snippet is iterable -%}\n            {% set kata = dict_set(kata, automation_key ~ '.inputs.' ~ input.snippet|keys|first, input.snippet|first) %}\n          {% else %}\n            {% set kata = dict_set(kata, automation_key ~ '.inputs.' ~ input.key, '') %}\n          {% endif -%}\n        {% endfor %}\n      {% endif %}\n      {% endapply %}\n      {{kata|kata_encode}}",
    "policy_kata": "",
    "created_at": 1600722810,
    "updated_at": 1624579447
}