{
    "name": "ai.cerb.automationBuilder.action.httpRequest",
    "description": "",
    "extension_id": "cerb.trigger.interaction.internal",
    "script": "start:\r\n  await:\r\n    form:\r\n      elements:\r\n        text/prompt_url:\r\n          label: URL:\r\n          default: https://example.com\r\n          type: url\r\n          required@bool: yes\r\n          \r\n        sheet/prompt_method:\r\n          label: Method:\r\n          required@bool: yes\r\n          data@json:\r\n            [\r\n              { \"name\": \"GET\" },\r\n              { \"name\": \"POST\" },\r\n              { \"name\": \"PUT\" },\r\n              { \"name\": \"DELETE\" }\r\n            ]\r\n          limit: 10\r\n          default: GET\r\n          schema:\r\n            layout:\r\n              headings@bool: no\r\n            columns:\r\n              selection/_selection:\r\n                params:\r\n                  mode: single\r\n                  value_key: name\r\n              text/name:\r\n        \r\n        sheet/has_auth:\r\n          label: Authorization:\r\n          required@bool: yes\r\n          data@json:\r\n            [\r\n              { \"name\": \"None\" },\r\n              { \"name\": \"OAuth\" },\r\n              { \"name\": \"AWS\" },\r\n              { \"name\": \"Bearer Token\" },\r\n              { \"name\": \"Other\" }\r\n            ]\r\n          limit: 10\r\n          default: None\r\n          schema:\r\n            layout:\r\n              headings@bool: no\r\n            columns:\r\n              selection/_selection:\r\n                params:\r\n                  mode: single\r\n                  value_key: name\r\n              text/name:\r\n              \r\n  decision/needs_auth:\r\n    outcome:\r\n      if@bool:\r\n        {{has_auth != 'None' ? 'yes'}}\r\n      then:\r\n        await:\r\n          form:\r\n            elements:\r\n              sheet/prompt_account_id:\r\n                label: Sign requests with which account?\r\n                data:\r\n                  automation:\r\n                    uri: cerb:automation:cerb.data.records\r\n                    inputs:\r\n                      record_type: connected_account\r\n                      query_required@text:\r\n                        {% if has_auth == 'OAuth' %}\r\n                        service:(type:oauth)\r\n                        {% elseif has_auth == 'AWS' %}\r\n                        service:(type:aws)\r\n                        {% elseif has_auth == 'Bearer Token' %}\r\n                        service:(type:bearer)\r\n                        {% endif %}\r\n                limit: 10\r\n                #default:\r\n                schema:\r\n                  layout:\r\n                    filtering@bool: yes\r\n                    headings@bool: no\r\n                  columns:\r\n                    selection/_selection:\r\n                      params:\r\n                        mode: single\r\n                        value_template@raw: {{uri ?: id}}\r\n                    card/_label:\r\n                      params:\r\n                        bold: yes\r\n                    text/uri:\r\n                    text/service_extension_name:\r\n                      params:\r\n                        underline@bool: no\r\n                      \r\n  return:\r\n    snippet@text:\r\n      http.request/{{random_string(6)|lower}}:\r\n        output: http_response\r\n        inputs:\r\n          method: {{prompt_method}}\r\n          url: {{prompt_url}}\r\n          #headers@text:\r\n          #  Content-Type: text/plain\r\n          #  X-HeaderName: Header value\r\n          #body@text:\r\n          #  This is the body content\r\n          {% if prompt_account_id -%}\r\n          authentication: cerb:connected_account:{{prompt_account_id}}\r\n          {% endif %}\r\n        # on_simulate:\r\n        #   set:\r\n        #     http_response:\r\n        #       status_code@int: 200\r\n        #       content_type: application/json\r\n        #       headers:\r\n        #         x-example: some header\r\n        #       body@text:\r\n        #         {status:\"ok\"}\r\n        on_success:\r\n        on_error:",
    "policy_kata": "",
    "created_at": 1600722810,
    "updated_at": 1617996760
}